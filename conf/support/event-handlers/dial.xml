<?xml version="1.0" encoding="UTF-8"?>
<beans>
  <bean id="dialListener" class="EventHandlers\DialListener" scope="singleton" listens-on="dialBegin, dialEnd">
    <property name="startCallStatement"><ref bean="startCallStatement"/></property>
    <property name="endCallStatement"><ref bean="endCallStatement"/></property>
  </bean>
  <bean id="startCallStatement" class="PDOStatement" scope="prototype" factory-bean="pdoMysql" factory-method="prepare">
    <constructor-arg><value>INSERT INTO `${mysql.table}` (`dialstring`, `clid_name`, `clid_num`, `channel_src`, `channel_dst`, `eventStart`, `uniqueid`) VALUES(:dialString, :clidName, :clidNum, :channelSrc, :channelDst, :eventStart, :uniqueid)</value></constructor-arg>
  </bean>
  <bean id="endCallStatement" class="PDOStatement" scope="prototype" factory-bean="pdoMysql" factory-method="prepare">
    <constructor-arg><value>UPDATE `${mysql.table}` SET `eventEnd`=:eventEnd, `status`=:status WHERE `uniqueid`=:uniqueid</value></constructor-arg>
  </bean>
  <bean id="pdoMysql" class="PDO" scope="singleton">
    <constructor-arg><value>mysql:dbname=${mysql.db};host=${mysql.host};port=${mysql.port}</value></constructor-arg>
    <constructor-arg><value>${mysql.username}</value></constructor-arg>
    <constructor-arg><value>${mysql.password}</value></constructor-arg>
  </bean>
</beans>
